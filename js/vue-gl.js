(function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,b.VueGL=a()}})(function(){function a(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function b(a){var c=a.$parent;if(c)return c.$options.isVglAssets?c:b(c)}function c(a,b){return Object.create(a&&a.assets[b])}function d(a){var b=new n.Vector3;switch("undefined"==typeof a?"undefined":m(a)){case"number":b.setScalar(a);break;case"object":Array.isArray(a)?1===a.length?b.setScalar(parseFloat(a[0])):b.fromArray(a.map(function(a){return parseFloat(a)})):b.setX(parseFloat(a.x||0)).setY(parseFloat(a.y||0)).setZ(parseFloat(a.z||0));break;case"string":if(a.includes(";")){var c=a.split(";").map(function(a){return a.split(":")}),d=c.reduce(function(a,b){return a[b[0].trim()]=b[1],a},{});b.setX(parseFloat(d.x)).setY(parseFloat(d.y)).setZ(parseFloat(d.z))}else{var e=a.trim().split(/\s+/);1===e.length?b.setScalar(parseFloat(e[0])):b.fromArray(e.map(function(a){return parseFloat(a)}))}}return b}function e(a){var b=new n.Euler;switch("undefined"==typeof a?"undefined":m(a)){case"object":if(Array.isArray(a))b.fromArray(a.map(function(a,b){return 3>b?parseFloat(a):a.trim()}));else{var c=parseFloat(a.x||0),d=parseFloat(a.y||0),f=parseFloat(a.z||0);b.set(c,d,f,a.order&&a.order.trim())}break;case"string":if(a.includes(";")){var g=a.split(";").map(function(a){return a.split(":")}),h=g.reduce(function(a,b){return a[b[0].trim()]=b[1],a},{}),e=parseFloat(h.x),i=parseFloat(h.y),j=parseFloat(h.z);b.set(e,i,j,h.order&&h.order.trim())}else{var k=a.trim().split(/\s+/);b.fromArray(k.map(function(a,b){return 3>b?parseFloat(a):a.trim()}))}}return b}function f(b){var c=new n.Spherical;switch("undefined"==typeof b?"undefined":m(b)){case"number":c.radius=b;break;case"object":if(Array.isArray(b))c.set.apply(c,a(b.map(function(a){return parseFloat(a)})));else{var d=parseFloat(b.radius||1),e=parseFloat(b.phi||0),f=parseFloat(b.theta||0);c.set(d,e,f)}break;case"string":if(b.includes(";")){var g=b.split(";").map(function(a){return a.split(":")}),h=g.reduce(function(a,b){return a[b[0].trim()]=b[1],a},{}),i=parseFloat(h.radius),j=parseFloat(h.phi),k=parseFloat(h.theta);c.set(i,j,k)}else{var l=b.trim().split(/\s+/);c.set.apply(c,a(l.map(function(a){return parseFloat(a)})))}}return c.makeSafe()}function g(a){var b=a.$parent;if(b)return b.inst&&b.inst.isObject3D?b:g(b)}function h(a,b){a&&(a.aspect=b.clientWidth/b.clientHeight,a.updateProjectionMatrix())}function i(a,b){a.setSize(b.clientWidth,b.clientHeight,!1)}function j(a){return Object.getPrototypeOf(a.assets.materials)}function k(a){return Object.getPrototypeOf(a.assets.geometries)}var l;"use strict",Object.defineProperty(l,"__esModule",{value:!0}),l.VglMeshStandardMaterial=l.VglSphereGeometry=l.VglGeometry=l.VglPointsMaterial=l.VglMaterial=l.VglAmbientLight=l.VglDirectionalLight=l.VglLight=l.VglGroup=l.VglPerspectiveCamera=l.VglRenderer=l.VglCamera=l.VglScene=l.VglObject3d=l.VglAssets=void 0;var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},n=require("three/build/three.module.js"),o={isVglAssets:!0,data:function(){var a=b(this)||null;return{assets:{materials:c(a,"materials"),geometries:c(a,"geometries"),attributes:c(a,"attributes")}}},render:function(a){if(this.$slots.default)return a("div",this.$slots.default)}},p={mixins:[o],props:["name","position","rotation","scale"],computed:{inst:function(){return new n.Object3D}},created:function(){var a=this.inst;this.position&&a.position.copy(d(this.position)),this.rotation&&a.rotation.copy(e(this.rotation)),this.scale&&a.scale.copy(d(this.scale));var b=g(this);b&&b.inst.add(a)},beforeDestroy:function(){var a=this.inst;a.parent&&a.parent.remove(a)},watch:{position:function(a){this.inst.position.copy(d(a))},rotation:function(a){this.inst.rotation.copy(e(a))},scale:function(a){this.inst.scale.copy(d(a||1))},inst:function(b,c){c.children.length&&b.add.apply(b,a(c.children)),b.position.copy(c.position),b.rotation.copy(c.rotation),b.scale.copy(c.scale);var d=c.parent;d&&(d.remove(c),d.add(b))}}},q={mixins:[p],props:["orbitTarget","orbitPosition"],inject:["cameras"],computed:{inst:function(){return new n.Camera}},created:function(){var a=this.inst,b=this.orbitPosition,c=this.orbitTarget;if(b||c){var e=d(c);b&&a.position.setFromSpherical(f(b)).add(e),a.lookAt(e)}this.$set(this.cameras,this.name,this.inst)},beforeDestroy:function(){this.cameras[this.name]===this.inst&&this.$delete(this.cameras,this.name)},watch:{inst:function(a){this.cameras[this.name]=a},orbitTarget:function(a){var b=this.inst,c=d(a);this.orbitPosition&&b.position.setFromSpherical(f(this.orbitPosition)).add(c),b.lookAt(c)},orbitPosition:function(a){var b=this.inst,c=f(a);b.position.setFromSpherical(c);var e=d(this.orbitTarget);this.orbitTarget&&b.add(e),b.lookAt(e)}}},r={mixins:[p],props:["color","intensity"],computed:{inst:function(){return new n.Light}},created:function(){this.color&&this.inst.color.setStyle(this.color),this.intensity&&(this.inst.intensity=parseFloat(this.intensity))},watch:{color:function(a){this.inst.color.setStyle(a)},intensity:function(a){this.inst.intensity=parseFloat(a)}}},s={mixins:[o],props:["name"],computed:{inst:function(){return new n.Material}},watch:{inst:function(a){var b=j(this);b&&(b[this.name]=a)}},created:function(){var a=j(this);a&&this.$set(a,this.name,this.inst)},beforeDestroy:function(){var a=j(this);a&&a[this.name]===this.inst&&this.$delete(a,this.name)}},t={mixins:[o],props:["name"],computed:{inst:function(){return new n.Geometry}},watch:{inst:function(a){var b=k(this);b&&(b[this.name]=a)}},created:function(){var a=k(this);a&&this.$set(a,this.name,this.inst)},beforeDestroy:function(){var a=k(this);a&&a[this.name]===this.inst&&this.$delete(a,this.name)}};l.VglAssets=o,l.VglObject3d=p,l.VglScene={mixins:[p],inject:["scenes"],computed:{inst:function(){return new n.Scene}},created:function(){this.$set(this.scenes,this.name,this.inst)},beforeDestroy:function(){this.scenes[this.name]===this.inst&&this.$delete(this.scenes,this.name)},watch:{inst:function(a){this.scenes[this.name]=a}}},l.VglCamera=q,l.VglRenderer={mixins:[o],props:["precision","alpha","premultipliedAlpha","antialias","stencil","preserveDrawingBuffer","depth","logarithmicDepthBuffer","camera","scene"],provide:function(){return{cameras:this.cameras,scenes:this.scenes,render:this.render}},data:function(){return{cameras:Object.create(null),scenes:Object.create(null),key:0,req:!0}},computed:{opt:function(){return{precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha===void 0||this.premultipliedAlpha,antialias:this.antialias,stencil:this.stencil===void 0||this.stencil,preserveDrawingBuffer:this.preserveDrawingBuffer,depth:this.depth===void 0||this.depth,logarithmicDepthBuffer:this.logarithmicDepthBuffer}},inst:function(){return new n.WebGLRenderer(Object.assign({canvas:this.$refs.renderer},this.opt))},cmr:function(){return this.cameras[this.camera]},scn:function(){return this.scenes[this.scene]}},methods:{resize:function(){i(this.inst,this.$el),h(this.cmr,this.$el),this.render()},render:function(){var a=this;this.req&&(this.$nextTick(function(){requestAnimationFrame(function(){a.scn&&a.cmr&&a.inst.render(a.scn,a.cmr),a.req=!0})}),this.req=!1)}},watch:{opt:function(){var a=this;++this.key,this.$nextTick(function(){a.resize()})},scn:function(){this.render()},cmr:function(a){h(a,this.$el),this.render()}},mounted:function(){this.resize()},render:function(a){return a("div",[a("canvas",{ref:"renderer",key:this.key},this.$slots.default)])}},l.VglPerspectiveCamera={mixins:[q],props:["zoom","near","far"],computed:{inst:function(){return new n.PerspectiveCamera}},created:function(){var a=this.inst;this.zoom&&(a.zoom=parseFloat(this.zoom)),this.near&&(a.near=parseFloat(this.near)),this.far&&(a.far=parseFloat(this.far))},watch:{zoom:function(a){this.inst.zoom=parseFloat(a)},near:function(a){this.inst.near=parseFloat(a)},far:function(a){this.inst.far=parseFloat(a)}}},l.VglGroup={mixins:[p],computed:{inst:function(){return new n.Group}}},l.VglLight=r,l.VglDirectionalLight={mixins:[r],computed:{inst:function(){return new n.DirectionalLight}}},l.VglAmbientLight={mixins:[r],computed:{inst:function(){return new n.AmbientLight}}},l.VglMaterial=s,l.VglPointsMaterial={mixins:[s],props:["color","size","sizeAttenuation"],computed:{inst:function(){return new n.PointsMaterial}},created:function(){this.color&&this.inst.color.setStyle(this.color),this.size&&(this.inst.size=parseFloat(this.size)),this.sizeAttenuation!==void 0&&(this.inst.sizeAttenuation=this.sizeAttenuation)},watch:{color:function(a){this.inst.color.setStyle(a)},size:function(a){this.inst.size=parseFloat(a)},sizeAttenuation:function(b){this.inst.sizeAttenuation=b}}},l.VglGeometry=t,l.VglSphereGeometry={mixins:[t],props:["radius","widthSegments","heightSegments","phiStart","phiLength","thetaStart","thetaLength"],computed:{inst:function(){return new n.SphereGeometry(parseFloat(this.radius),parseFloat(this.widthSegments),parseFloat(this.heightSegments),parseFloat(this.phiStart),parseFloat(this.phiLength),parseFloat(this.thetaStart),parseFloat(this.thetaLength))}}},l.VglMeshStandardMaterial={mixins:[s],props:["color"],computed:{inst:function(){return new n.MeshStandardMaterial}},created:function(){this.color&&this.inst.color.setStyle(this.color)},watch:{color:function(a){this.inst.color.setStyle(a)}}}});

