(function(a,b){if("function"==typeof define&&define.amd)define(["exports","three/build/three.module.js"],b);else if("undefined"!=typeof exports)b(exports,require("three/build/three.module.js"));else{var c={exports:{}};b(c.exports,a.threeModule),a.unknown=c.exports}})(this,function(a,b){"use strict";function c(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function d(a){var b=a.$parent;if(b)return b.$options.isVglAssets?b:d(b)}function e(a,b){return Object.create(a&&a.assets[b])}function f(a){var c=new b.Vector3;switch("undefined"==typeof a?"undefined":n(a)){case"number":c.setScalar(a);break;case"object":Array.isArray(a)?1===a.length?c.setScalar(parseFloat(a[0])):c.fromArray(a.map(function(a){return parseFloat(a)})):c.setX(parseFloat(a.x||0)).setY(parseFloat(a.y||0)).setZ(parseFloat(a.z||0));break;case"string":if(a.includes(";")){var d=a.split(";").map(function(a){return a.split(":")}),e=d.reduce(function(a,b){return a[b[0].trim()]=b[1],a},{});c.setX(parseFloat(e.x)).setY(parseFloat(e.y)).setZ(parseFloat(e.z))}else{var f=a.trim().split(/\s+/);1===f.length?c.setScalar(parseFloat(f[0])):c.fromArray(f.map(function(a){return parseFloat(a)}))}}return c}function g(a){var c=new b.Euler;switch("undefined"==typeof a?"undefined":n(a)){case"object":if(Array.isArray(a))c.fromArray(a.map(function(a,b){return 3>b?parseFloat(a):a.trim()}));else{var d=parseFloat(a.x||0),f=parseFloat(a.y||0),g=parseFloat(a.z||0);c.set(d,f,g,a.order&&a.order.trim())}break;case"string":if(a.includes(";")){var h=a.split(";").map(function(a){return a.split(":")}),i=h.reduce(function(a,b){return a[b[0].trim()]=b[1],a},{}),e=parseFloat(i.x),j=parseFloat(i.y),k=parseFloat(i.z);c.set(e,j,k,i.order&&i.order.trim())}else{var l=a.trim().split(/\s+/);c.fromArray(l.map(function(a,b){return 3>b?parseFloat(a):a.trim()}))}}return c}function h(a){var d=new b.Spherical;switch("undefined"==typeof a?"undefined":n(a)){case"number":d.radius=a;break;case"object":if(Array.isArray(a))d.set.apply(d,c(a.map(function(a){return parseFloat(a)})));else{var e=parseFloat(a.radius||1),f=parseFloat(a.phi||0),g=parseFloat(a.theta||0);d.set(e,f,g)}break;case"string":if(a.includes(";")){var h=a.split(";").map(function(a){return a.split(":")}),i=h.reduce(function(a,b){return a[b[0].trim()]=b[1],a},{}),j=parseFloat(i.radius),k=parseFloat(i.phi),l=parseFloat(i.theta);d.set(j,k,l)}else{var m=a.trim().split(/\s+/);d.set.apply(d,c(m.map(function(a){return parseFloat(a)})))}}return d.makeSafe()}function i(a){var b=a.$parent;if(b)return b.inst&&b.inst.isObject3D?b:i(b)}function j(a,b){a&&(a.aspect=b.clientWidth/b.clientHeight,a.updateProjectionMatrix())}function k(a,b){a.setSize(b.clientWidth,b.clientHeight,!1)}function l(a){return Object.getPrototypeOf(a.assets.materials)}function m(a){return Object.getPrototypeOf(a.assets.geometries)}Object.defineProperty(a,"__esModule",{value:!0}),a.VglMeshStandardMaterial=a.VglSphereGeometry=a.VglGeometry=a.VglPointsMaterial=a.VglMaterial=a.VglAmbientLight=a.VglDirectionalLight=a.VglLight=a.VglGroup=a.VglPerspectiveCamera=a.VglRenderer=a.VglCamera=a.VglScene=a.VglObject3d=a.VglAssets=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},o={isVglAssets:!0,data:function(){var a=d(this)||null;return{assets:{materials:e(a,"materials"),geometries:e(a,"geometries"),attributes:e(a,"attributes")}}},render:function(a){if(this.$slots.default)return a("div",this.$slots.default)}},p={mixins:[o],props:["name","position","rotation","scale"],computed:{inst:function(){return new b.Object3D}},created:function(){var a=this.inst;this.position&&a.position.copy(f(this.position)),this.rotation&&a.rotation.copy(g(this.rotation)),this.scale&&a.scale.copy(f(this.scale));var b=i(this);b&&b.inst.add(a)},beforeDestroy:function(){var a=this.inst;a.parent&&a.parent.remove(a)},watch:{position:function(a){this.inst.position.copy(f(a))},rotation:function(a){this.inst.rotation.copy(g(a))},scale:function(a){this.inst.scale.copy(f(a||1))},inst:function(a,b){b.children.length&&a.add.apply(a,c(b.children)),a.position.copy(b.position),a.rotation.copy(b.rotation),a.scale.copy(b.scale);var d=b.parent;d&&(d.remove(b),d.add(a))}}},q={mixins:[p],props:["orbitTarget","orbitPosition"],inject:["cameras"],computed:{inst:function(){return new b.Camera}},created:function(){var a=this.inst,b=this.orbitPosition,c=this.orbitTarget;if(b||c){var d=f(c);b&&a.position.setFromSpherical(h(b)).add(d),a.lookAt(d)}this.$set(this.cameras,this.name,this.inst)},beforeDestroy:function(){this.cameras[this.name]===this.inst&&this.$delete(this.cameras,this.name)},watch:{inst:function(a){this.cameras[this.name]=a},orbitTarget:function(a){var b=this.inst,c=f(a);this.orbitPosition&&b.position.setFromSpherical(h(this.orbitPosition)).add(c),b.lookAt(c)},orbitPosition:function(a){var b=this.inst,c=h(a);b.position.setFromSpherical(c);var d=f(this.orbitTarget);this.orbitTarget&&b.add(d),b.lookAt(d)}}},r={mixins:[p],props:["color","intensity"],computed:{inst:function(){return new b.Light}},created:function(){this.color&&this.inst.color.setStyle(this.color),this.intensity&&(this.inst.intensity=parseFloat(this.intensity))},watch:{color:function(a){this.inst.color.setStyle(a)},intensity:function(a){this.inst.intensity=parseFloat(a)}}},s={mixins:[o],props:["name"],computed:{inst:function(){return new b.Material}},watch:{inst:function(a){var b=l(this);b&&(b[this.name]=a)}},created:function(){var a=l(this);a&&this.$set(a,this.name,this.inst)},beforeDestroy:function(){var a=l(this);a&&a[this.name]===this.inst&&this.$delete(a,this.name)}},t={mixins:[o],props:["name"],computed:{inst:function(){return new b.Geometry}},watch:{inst:function(a){var b=m(this);b&&(b[this.name]=a)}},created:function(){var a=m(this);a&&this.$set(a,this.name,this.inst)},beforeDestroy:function(){var a=m(this);a&&a[this.name]===this.inst&&this.$delete(a,this.name)}};a.VglAssets=o,a.VglObject3d=p,a.VglScene={mixins:[p],inject:["scenes"],computed:{inst:function(){return new b.Scene}},created:function(){this.$set(this.scenes,this.name,this.inst)},beforeDestroy:function(){this.scenes[this.name]===this.inst&&this.$delete(this.scenes,this.name)},watch:{inst:function(a){this.scenes[this.name]=a}}},a.VglCamera=q,a.VglRenderer={mixins:[o],props:["precision","alpha","premultipliedAlpha","antialias","stencil","preserveDrawingBuffer","depth","logarithmicDepthBuffer","camera","scene"],provide:function(){return{cameras:this.cameras,scenes:this.scenes,render:this.render}},data:function(){return{cameras:Object.create(null),scenes:Object.create(null),key:0,req:!0}},computed:{opt:function(){return{precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha===void 0||this.premultipliedAlpha,antialias:this.antialias,stencil:this.stencil===void 0||this.stencil,preserveDrawingBuffer:this.preserveDrawingBuffer,depth:this.depth===void 0||this.depth,logarithmicDepthBuffer:this.logarithmicDepthBuffer}},inst:function(){return new b.WebGLRenderer(Object.assign({canvas:this.$refs.renderer},this.opt))},cmr:function(){return this.cameras[this.camera]},scn:function(){return this.scenes[this.scene]}},methods:{resize:function(){k(this.inst,this.$el),j(this.cmr,this.$el),this.render()},render:function(){var a=this;this.req&&(this.$nextTick(function(){requestAnimationFrame(function(){a.scn&&a.cmr&&a.inst.render(a.scn,a.cmr),a.req=!0})}),this.req=!1)}},watch:{opt:function(){var a=this;++this.key,this.$nextTick(function(){a.resize()})},scn:function(){this.render()},cmr:function(a){j(a,this.$el),this.render()}},mounted:function(){this.resize()},render:function(a){return a("div",[a("canvas",{ref:"renderer",key:this.key},this.$slots.default)])}},a.VglPerspectiveCamera={mixins:[q],props:["zoom","near","far"],computed:{inst:function(){return new b.PerspectiveCamera}},created:function(){var a=this.inst;this.zoom&&(a.zoom=parseFloat(this.zoom)),this.near&&(a.near=parseFloat(this.near)),this.far&&(a.far=parseFloat(this.far))},watch:{zoom:function(a){this.inst.zoom=parseFloat(a)},near:function(a){this.inst.near=parseFloat(a)},far:function(a){this.inst.far=parseFloat(a)}}},a.VglGroup={mixins:[p],computed:{inst:function(){return new b.Group}}},a.VglLight=r,a.VglDirectionalLight={mixins:[r],computed:{inst:function(){return new b.DirectionalLight}}},a.VglAmbientLight={mixins:[r],computed:{inst:function(){return new b.AmbientLight}}},a.VglMaterial=s,a.VglPointsMaterial={mixins:[s],props:["color","size","sizeAttenuation"],computed:{inst:function(){return new b.PointsMaterial}},created:function(){this.color&&this.inst.color.setStyle(this.color),this.size&&(this.inst.size=parseFloat(this.size)),this.sizeAttenuation!==void 0&&(this.inst.sizeAttenuation=this.sizeAttenuation)},watch:{color:function(a){this.inst.color.setStyle(a)},size:function(a){this.inst.size=parseFloat(a)},sizeAttenuation:function(b){this.inst.sizeAttenuation=b}}},a.VglGeometry=t,a.VglSphereGeometry={mixins:[t],props:["radius","widthSegments","heightSegments","phiStart","phiLength","thetaStart","thetaLength"],computed:{inst:function(){return new b.SphereGeometry(parseFloat(this.radius),parseFloat(this.widthSegments),parseFloat(this.heightSegments),parseFloat(this.phiStart),parseFloat(this.phiLength),parseFloat(this.thetaStart),parseFloat(this.thetaLength))}}},a.VglMeshStandardMaterial={mixins:[s],props:["color"],computed:{inst:function(){return new b.MeshStandardMaterial}},created:function(){this.color&&this.inst.color.setStyle(this.color)},watch:{color:function(a){this.inst.color.setStyle(a)}}}});

