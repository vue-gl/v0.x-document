'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}(function(a,b){'object'===('undefined'==typeof exports?'undefined':_typeof(exports))&&'undefined'!=typeof module?b(exports,require('three/build/three.module.js')):'function'==typeof define&&define.amd?define(['exports','three/build/three.module.js'],b):b(a.VueGL={},a.THREE)})(void 0,function(a,b){'use strict';function c(a){var b=a.$parent;if(b)return b.$options.isVglAssets?b:c(b)}function d(a,b){return Object.create(a&&a.assets[b])}function e(a){var c=new b.Vector3;switch('undefined'==typeof a?'undefined':_typeof(a)){case'number':c.setScalar(a);break;case'object':Array.isArray(a)?1===a.length?c.setScalar(parseFloat(a[0])):c.fromArray(a.map(function(a){return parseFloat(a)})):c.setX(parseFloat(a.x||0)).setY(parseFloat(a.y||0)).setZ(parseFloat(a.z||0));break;case'string':if(a.includes(';')){var d=a.split(';').map(function(a){return a.split(':')}),e=d.reduce(function(a,b){return a[b[0].trim()]=b[1],a},{});c.setX(parseFloat(e.x)).setY(parseFloat(e.y)).setZ(parseFloat(e.z))}else{var f=a.trim().split(/\s+/);1===f.length?c.setScalar(parseFloat(f[0])):c.fromArray(f.map(function(a){return parseFloat(a)}))}}return c}function f(a){var c=new b.Euler;switch('undefined'==typeof a?'undefined':_typeof(a)){case'object':if(Array.isArray(a))c.fromArray(a.map(function(a,b){return 3>b?parseFloat(a):a.trim()}));else{var d=parseFloat(a.x||0),f=parseFloat(a.y||0),g=parseFloat(a.z||0);c.set(d,f,g,a.order&&a.order.trim())}break;case'string':if(a.includes(';')){var h=a.split(';').map(function(a){return a.split(':')}),i=h.reduce(function(a,b){return a[b[0].trim()]=b[1],a},{}),e=parseFloat(i.x),j=parseFloat(i.y),k=parseFloat(i.z);c.set(e,j,k,i.order&&i.order.trim())}else{var l=a.trim().split(/\s+/);c.fromArray(l.map(function(a,b){return 3>b?parseFloat(a):a.trim()}))}}return c}function g(a){var c=new b.Spherical;switch('undefined'==typeof a?'undefined':_typeof(a)){case'number':c.radius=a;break;case'object':if(Array.isArray(a))c.set.apply(c,_toConsumableArray(a.map(function(a){return parseFloat(a)})));else{var d=parseFloat(a.radius||1),e=parseFloat(a.phi||0),f=parseFloat(a.theta||0);c.set(d,e,f)}break;case'string':if(a.includes(';')){var g=a.split(';').map(function(a){return a.split(':')}),h=g.reduce(function(a,b){return a[b[0].trim()]=b[1],a},{}),i=parseFloat(h.radius),j=parseFloat(h.phi),k=parseFloat(h.theta);c.set(i,j,k)}else{var l=a.trim().split(/\s+/);c.set.apply(c,_toConsumableArray(l.map(function(a){return parseFloat(a)})))}}return c.makeSafe()}function h(a){var b=a.$parent;if(b)return b.inst&&b.inst.isObject3D?b:h(b)}function i(a,b){a&&(a.aspect=b.clientWidth/b.clientHeight,a.updateProjectionMatrix())}function j(a,b){a.setSize(b.clientWidth,b.clientHeight,!1)}function k(a){return Object.getPrototypeOf(a.assets.materials)}function l(a){return Object.getPrototypeOf(a.assets.geometries)}var m={isVglAssets:!0,data:function data(){var a=c(this)||null;return{assets:{materials:d(a,'materials'),geometries:d(a,'geometries'),attributes:d(a,'attributes')}}},render:function render(a){if(this.$slots.default)return a('div',this.$slots.default)}},n={mixins:[m],props:['name','position','rotation','scale'],computed:{inst:function inst(){return new b.Object3D}},created:function created(){var a=this.inst;this.position&&a.position.copy(e(this.position)),this.rotation&&a.rotation.copy(f(this.rotation)),this.scale&&a.scale.copy(e(this.scale));var b=h(this);b&&b.inst.add(a)},beforeDestroy:function beforeDestroy(){var a=this.inst;a.parent&&a.parent.remove(a)},watch:{position:function position(a){this.inst.position.copy(e(a))},rotation:function rotation(a){this.inst.rotation.copy(f(a))},scale:function scale(a){this.inst.scale.copy(e(a||1))},inst:function inst(a,b){b.children.length&&a.add.apply(a,_toConsumableArray(b.children)),a.position.copy(b.position),a.rotation.copy(b.rotation),a.scale.copy(b.scale);var c=b.parent;c&&(c.remove(b),c.add(a))}}},o={mixins:[n],props:['orbitTarget','orbitPosition'],inject:['cameras'],computed:{inst:function inst(){return new b.Camera}},created:function created(){var a=this.inst,b=this.orbitPosition,c=this.orbitTarget;if(b||c){var d=e(c);b&&a.position.setFromSpherical(g(b)).add(d),a.lookAt(d)}this.$set(this.cameras,this.name,this.inst)},beforeDestroy:function beforeDestroy(){this.cameras[this.name]===this.inst&&this.$delete(this.cameras,this.name)},watch:{inst:function inst(a){this.cameras[this.name]=a},orbitTarget:function orbitTarget(a){var b=this.inst,c=e(a);this.orbitPosition&&b.position.setFromSpherical(g(this.orbitPosition)).add(c),b.lookAt(c)},orbitPosition:function orbitPosition(a){var b=this.inst,c=g(a);b.position.setFromSpherical(c);var d=e(this.orbitTarget);this.orbitTarget&&b.add(d),b.lookAt(d)}}},p={mixins:[n],props:['color','intensity'],computed:{inst:function inst(){return new b.Light}},created:function created(){this.color&&this.inst.color.setStyle(this.color),this.intensity&&(this.inst.intensity=parseFloat(this.intensity))},watch:{color:function color(a){this.inst.color.setStyle(a)},intensity:function intensity(a){this.inst.intensity=parseFloat(a)}}},q={mixins:[m],props:['name'],computed:{inst:function inst(){return new b.Material}},watch:{inst:function inst(a){var b=k(this);b&&(b[this.name]=a)}},created:function created(){var a=k(this);a&&this.$set(a,this.name,this.inst)},beforeDestroy:function beforeDestroy(){var a=k(this);a&&a[this.name]===this.inst&&this.$delete(a,this.name)}},r={mixins:[m],props:['name'],computed:{inst:function inst(){return new b.Geometry}},watch:{inst:function inst(a){var b=l(this);b&&(b[this.name]=a)}},created:function created(){var a=l(this);a&&this.$set(a,this.name,this.inst)},beforeDestroy:function beforeDestroy(){var a=l(this);a&&a[this.name]===this.inst&&this.$delete(a,this.name)}};a.VglAssets=m,a.VglObject3d=n,a.VglScene={mixins:[n],inject:['scenes'],computed:{inst:function inst(){return new b.Scene}},created:function created(){this.$set(this.scenes,this.name,this.inst)},beforeDestroy:function beforeDestroy(){this.scenes[this.name]===this.inst&&this.$delete(this.scenes,this.name)},watch:{inst:function inst(a){this.scenes[this.name]=a}}},a.VglCamera=o,a.VglRenderer={mixins:[m],props:['precision','alpha','premultipliedAlpha','antialias','stencil','preserveDrawingBuffer','depth','logarithmicDepthBuffer','camera','scene'],provide:function provide(){return{cameras:this.cameras,scenes:this.scenes,render:this.render}},data:function data(){return{cameras:Object.create(null),scenes:Object.create(null),key:0,req:!0}},computed:{opt:function opt(){return{precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha===void 0||this.premultipliedAlpha,antialias:this.antialias,stencil:this.stencil===void 0||this.stencil,preserveDrawingBuffer:this.preserveDrawingBuffer,depth:this.depth===void 0||this.depth,logarithmicDepthBuffer:this.logarithmicDepthBuffer}},inst:function inst(){return new b.WebGLRenderer(Object.assign({canvas:this.$refs.renderer},this.opt))},cmr:function cmr(){return this.cameras[this.camera]},scn:function scn(){return this.scenes[this.scene]}},methods:{resize:function resize(){j(this.inst,this.$el),i(this.cmr,this.$el),this.render()},render:function render(){var a=this;this.req&&(this.$nextTick(function(){requestAnimationFrame(function(){a.scn&&a.cmr&&a.inst.render(a.scn,a.cmr),a.req=!0})}),this.req=!1)}},watch:{opt:function opt(){var a=this;++this.key,this.$nextTick(function(){a.resize()})},scn:function scn(){this.render()},cmr:function cmr(a){i(a,this.$el),this.render()}},mounted:function mounted(){this.resize()},render:function render(a){return a('div',[a('canvas',{ref:'renderer',key:this.key},this.$slots.default)])}},a.VglPerspectiveCamera={mixins:[o],props:['zoom','near','far'],computed:{inst:function inst(){return new b.PerspectiveCamera}},created:function created(){var a=this.inst;this.zoom&&(a.zoom=parseFloat(this.zoom)),this.near&&(a.near=parseFloat(this.near)),this.far&&(a.far=parseFloat(this.far))},watch:{zoom:function zoom(a){this.inst.zoom=parseFloat(a)},near:function near(a){this.inst.near=parseFloat(a)},far:function far(a){this.inst.far=parseFloat(a)}}},a.VglGroup={mixins:[n],computed:{inst:function inst(){return new b.Group}}},a.VglLight=p,a.VglDirectionalLight={mixins:[p],computed:{inst:function inst(){return new b.DirectionalLight}}},a.VglAmbientLight={mixins:[p],computed:{inst:function inst(){return new b.AmbientLight}}},a.VglMaterial=q,a.VglPointsMaterial={mixins:[q],props:['color','size','sizeAttenuation'],computed:{inst:function inst(){return new b.PointsMaterial}},created:function created(){this.color&&this.inst.color.setStyle(this.color),this.size&&(this.inst.size=parseFloat(this.size)),this.sizeAttenuation!==void 0&&(this.inst.sizeAttenuation=this.sizeAttenuation)},watch:{color:function color(a){this.inst.color.setStyle(a)},size:function size(a){this.inst.size=parseFloat(a)},sizeAttenuation:function sizeAttenuation(b){this.inst.sizeAttenuation=b}}},a.VglGeometry=r,a.VglSphereGeometry={mixins:[r],props:['radius','widthSegments','heightSegments','phiStart','phiLength','thetaStart','thetaLength'],computed:{inst:function inst(){return new b.SphereGeometry(parseFloat(this.radius),parseFloat(this.widthSegments),parseFloat(this.heightSegments),parseFloat(this.phiStart),parseFloat(this.phiLength),parseFloat(this.thetaStart),parseFloat(this.thetaLength))}}},a.VglMeshStandardMaterial={mixins:[q],props:['color'],computed:{inst:function inst(){return new b.MeshStandardMaterial}},created:function created(){this.color&&this.inst.color.setStyle(this.color)},watch:{color:function color(a){this.inst.color.setStyle(a)}}},Object.defineProperty(a,'__esModule',{value:!0})});
